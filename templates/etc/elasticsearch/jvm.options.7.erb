# This file is managed by Puppet -- <%= @name %>
#
# Set the 'jvm_options' parameter on the elasticsearch class to change this file.
<%
def set_default(options, match_string, default)
  options.detect {|o| o.include?(match_string)} || options.push(default)
end

defaults = {
  '-Xms' => '-Xms2g',
  '-Xmx' => '-Xmx2g',
  '-Djava.io.tmpdir' => '-Djava.io.tmpdir=${ES_TMPDIR}',
  'ErrorFile' => "-XX:ErrorFile=#{@logdir}/hs_err_pid%p.log",
  'UseG1GC' => '-XX:+UseG1GC',
  'G1ReservePercent' => '-XX:G1ReservePercent=25',
  'HeapDumpOnOutOfMemoryError' => '-XX:+HeapDumpOnOutOfMemoryError',
  'HeapDumpPath' => '-XX:HeapDumpPath=/var/lib/elasticsearch',
  'InitiatingHeapOccupancyPercent' => '-XX:InitiatingHeapOccupancyPercent=30',
  'Xloggc' => "-Xlog:gc*,gc+age=trace,safepoint:file=#{@logdir}/gc.log:utctime,pid,tags:filecount=32,filesize=64m",
}
defaults.each {|k,v| set_default(@jvm_options, k, v)}

-%>

<% @jvm_options.sort.each do |line| -%>
<%= line %>
<% end -%>
